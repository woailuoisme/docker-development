# MongoDB 8.0 推荐配置文件 (适用于 Docker 环境)
# 详情参考: https://www.mongodb.com/docs/manual/reference/configuration-options/

# --- 存储配置 ---
storage:
  # 数据库文件存储目录
  dbPath: /data/db
  # 目录结构: 每个数据库使用独立目录 (推荐启用，但只能在初始化空数据库时开启)
  # directoryPerDB: true

  # WiredTiger 存储引擎优化
  wiredTiger:
    engineConfig:
      # 缓存大小: 默认为 (总内存 - 1GB) 的 50%
      # 在容器环境下，如果限制了内存，建议手动设置 (例如 1GB 内存建议设为 0.25)
      # cacheSizeGB: 0.25
      
      # 统计日志记录频率 (秒)
      statisticsLogDelaySecs: 0
      # 目录结构: 索引和集合分别存储在独立子目录 (推荐启用，但只能在初始化空数据库时开启)
      # directoryForIndexes: true

# --- 网络配置 ---
net:
  # 监听端口
  port: 27017
  # 绑定 IP: 0.0.0.0 表示允许所有网络访问 (在 Docker 中必须)
  bindIp: 0.0.0.0
  # 最大连接数
  maxIncomingConnections: 1000

# --- 安全配置 ---
security:
  # 启用基于角色的访问控制 (配合环境变量使用)
  # 注意: 如果提供了 MONGO_INITDB_ROOT_USERNAME, Docker 镜像会自动开启
  authorization: enabled
  # 副本集集群内部认证文件 (副本集模式时使用)
  # keyFile: /etc/mongodb/keyfile

# --- 系统日志配置 ---
systemLog:
  # 日志输出目标: file 表示文件, syslog 表示系统日志
  # 在 Docker 环境中，通常注释掉以下两行，让日志输出到 stdout 方便采集
  # destination: file
  # path: /var/log/mongodb/mongod.log
  # 启动时是否追加日志 (而不是覆盖)
  logAppend: true
  # 日志级别 (0-5)
  verbosity: 0
  # 记录所有组件的日志明细 (可选)
  component:
    accessControl:
      verbosity: 0
    storage:
      verbosity: 0

# --- 性能分析 (慢查询记录) ---
operationProfiling:
  # 模式: off, slowOp (仅慢查询), all
  mode: slowOp
  # 慢查询阈值 (毫秒): 超过此数值的操作将被记录到日志
  slowOpThresholdMs: 100
  # 慢查询记录采样率 (0.0-1.0)
  slowOpSampleRate: 1.0

# --- 进程管理 ---
processManagement:
  # 时间区显示
  timeZoneInfo: /usr/share/zoneinfo

# --- 副本集配置 (可选) ---
# replication:
#   replSetName: "rs0"
#   oplogSizeMB: 1024
