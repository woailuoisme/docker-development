services:
  nginx-tester:
    image: jiaoio/nginx-base:1.29.4-trixie
    container_name: nginx-perf-tester
    volumes:
      - ./config/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./config/security-headers.conf:/etc/nginx/security-headers.conf:ro
      - ./config/waf.conf:/etc/nginx/waf.conf:ro
      - ./config/default.conf:/etc/nginx/default.conf:ro
    ports:
      - "8080:80"
    tty: true
    stdin_open: true
    command: >
      bash -c "
      echo 'ðŸš€ Starting High Performance Nginx Tester...' &&
      echo 'âœ… Zstd/Brotli Modules will be loaded from /usr/lib/nginx/modules/' &&
      nginx -g 'daemon off;'"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/api/test"]
      interval: 10s
      timeout: 5s
      retries: 3