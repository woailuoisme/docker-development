[mysqld]
# --- 基础与字符集 ---
# 默认字符集设置为极力推荐的 utf8mb4
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci

# --- 认证插件 ---
# 8.4 默认已经是 caching_sha2_password，且该参数已移除
# 如果需显式指定或修改策略，8.4 推荐使用 authentication_policy
# authentication_policy=caching_sha2_password
# 兼容性提示：如果旧版客户端(如 Navicat 12)连不上，请取消下面一行的注释
# mysql_native_password=ON

# --- 网络优化 ---
# 禁用 DNS 反向解析，极大提升 Docker 环境下的连接握手速度，防止因网络解析导致的瞬间连接缓慢
skip-name-resolve

# --- 内存与性能优化 (核心) ---
# InnoDB 缓冲池大小，通常设置为物理内存的 50%-75%
innodb_buffer_pool_size=512M
# 8.4 推荐：自动管理 Redo Log 容量，建议设为 buffer_pool 的同等或更大，此处设为 512M
innodb_redo_log_capacity=512M
# 事务刷盘策略：2 表示每秒刷盘，在保证较高安全性的同时获得极大的 IO 性能提升 (适合 SSD)
innodb_flush_log_at_trx_commit=2

# --- SSD IO 性能微调 ---
# 针对 SSD 的随机 IO 能力，提高后台写线程的活跃度
innodb_io_capacity=2000
innodb_io_capacity_max=4000
# 绕过操作系统缓存直接写入磁盘，减少双重缓冲，对 Linux 上的生产环境非常有益
innodb_flush_method=O_DIRECT

# --- 连接与限制 ---
# 最大连接数，根据应用规模调整
max_connections=500
# 数据包最大限制，防止大数据导入或大型 SQL 语句报错
max_allowed_packet=64M
# 能够同时打开的表数量缓存，提高多表查询性能
table_open_cache=2000

# --- 慢查询日志 ---
# 开启慢查询记录，帮助定位系统瓶颈
slow_query_log=1
# 执行时间超过 1 秒的均视为慢查询
long_query_time=1
# 日志存储路径 (已挂载到 DATA_PATH/mysql8 目录)
slow_query_log_file=/var/lib/mysql/mysql-slow.log