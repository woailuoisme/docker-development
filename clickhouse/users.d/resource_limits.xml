<clickhouse>
    <profiles>
        <default>
            <!-- 单查询最大线程数（2核优化） -->
            <max_threads>2</max_threads>
            
            <!-- 单次读取块大小，降低内存使用 -->
            <max_block_size>8192</max_block_size>
            
            <!-- 查询队列等待时间 1 秒 -->
            <queue_max_wait_ms>1000</queue_max_wait_ms>
            
            <!-- 查询最大执行时间 10 分钟 -->
            <max_execution_time>600</max_execution_time>
            
            <!-- 禁用并行解析和格式化，节省内存 -->
            <input_format_parallel_parsing>0</input_format_parallel_parsing>
            <output_format_parallel_formatting>0</output_format_parallel_formatting>
            
            <!-- GROUP BY 和 ORDER BY 超过 3GB 溢出到磁盘 -->
            <max_bytes_before_external_group_by>3221225472</max_bytes_before_external_group_by>
            <max_bytes_before_external_sort>3221225472</max_bytes_before_external_sort>
            
            <!-- 启用异步插入，不等待完成 -->
            <async_insert>1</async_insert>
            <wait_for_async_insert>0</wait_for_async_insert>
        </default>
    </profiles>
</clickhouse>
