services:
  php-roadrunner:
    image: jiaoio/php-roadrunner-trixie:8.5
    container_name: php-roadrunner
    restart: always
    environment:
      - APP_PATH=${APP_PATH}
      - APP_ENV=${APP_ENV}
      - APP_DEBUG=false
      - OCTANE_WORKERS=${OCTANE_WORKERS:-4}
      - OCTANE_MAX_REQUESTS=${OCTANE_MAX_REQUESTS:-1000}
      - WATCH=false
    ports:
      - "8201:8001"
    volumes:
      - ${APP_CODE_PATH}:${APP_CODE_PATH_CONTAINER}${APP_CODE_CONTAINER_FLAG}
      - ${CONFIG_PATH}ssh:/home/www-data/.ssh:ro
    networks:
      - backend
      - frontend
    depends_on:
      - redis
      - postgres
      - minio
      - meilisearch
      - php-horizon
      - php-schedule
    extra_hosts:
      - "host.docker.internal:host-gateway"
