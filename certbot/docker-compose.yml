services:
  certbot:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: certbot
    environment:
      - DNS_PROVIDER=${CERTBOT_DNS_PROVIDER:-aliyun} # DNS 提供商: cloudflare 或 aliyun
#      - DOMAIN=${DOMAIN:-haoxiaoguai.xyz} # 主域名
      - DOMAIN=haoxiaoguai.xyz # 主域名
      - EMAIL=${CERTBOT_EMAIL:-admin@haoxiaoguai.xyz} # 证书通知邮箱
      # Cloudflare DNS 凭据 (使用 API Token 或 API Key + Email)
      - CLOUDFLARE_API_TOKEN=${CLOUDFLARE_API_TOKEN} # Cloudflare API Token (推荐)
      - CLOUDFLARE_API_KEY=${CLOUDFLARE_API_KEY} # Cloudflare API Key (备选)
      - CLOUDFLARE_EMAIL=${CLOUDFLARE_EMAIL} # Cloudflare 邮箱 (配合 API Key 使用)
      # 阿里云 DNS 凭据
      - ALIYUN_ACCESS_KEY_ID=${ALIYUN_ACCESS_KEY_ID} # 阿里云 Access Key ID
      - ALIYUN_ACCESS_KEY_SECRET=${ALIYUN_ACCESS_KEY_SECRET} # 阿里云 Access Key Secret
      - TZ=Asia/Shanghai
    volumes:
#      - ${CONFIG_PATH}certbot/archive:/etc/letsencrypt/archive
#      - ${CONFIG_PATH}certbot/live:/etc/letsencrypt/live
      - ${CONFIG_PATH}certbot/data:/etc/letsencrypt
      - ${LOG_PATH}certbot/logs:/var/log/letsencrypt
    restart: unless-stopped
    networks:
      - frontend
      - backend