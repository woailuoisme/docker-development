# ========================================
# RabbitMQ 4.2 配置 (2核 1GB 环境)
# ========================================

## 网络配置
# AMQP 协议监听端口
listeners.tcp.default = 5672
# 心跳检测间隔（秒）
heartbeat = 60
# TCP 连接接受器进程数
num_acceptors.tcp = 10

## 内存管理
# 内存高水位标记，超过此值触发流量控制
vm_memory_high_watermark.absolute = 600MB
# 达到高水位 50% 时开始将消息写入磁盘
vm_memory_high_watermark_paging_ratio = 0.5
# 内存计算策略，rss 使用系统实际内存报告
vm_memory_calculation_strategy = rss

## 磁盘管理
# 磁盘最小可用空间，低于此值触发告警
disk_free_limit.absolute = 1GB

## 性能监控
# 统计信息收集级别，fine 提供详细队列速率
collect_statistics = fine
# 统计信息刷新间隔（毫秒）
collect_statistics_interval = 5000
# 管理界面速率显示模式，detailed 显示更多指标
management.rates_mode = detailed

## 队列优化
# 小于 4KB 的消息直接嵌入索引，提升读取性能
queue_index_embed_msgs_below = 4096

## 消费者保护
# 消费者超时时间（毫秒），防止僵尸消费者
consumer_timeout = 3600000

## 集群策略
# 网络分区时的处理策略，暂停少数派节点
cluster_partition_handling = pause_minority

## 日志配置
# 控制台日志级别
log.console.level = info
# 文件日志级别
log.file.level = info

## GC 优化
# 开启后台垃圾回收，减少延迟尖峰
background_gc_enabled = true
# 后台 GC 执行间隔（毫秒）
background_gc_target_interval = 60000

## 管理插件
# Web 管理界面 HTTP 端口
management.tcp.port = 15672
# 管理界面监听地址，0.0.0.0 表示所有接口
management.tcp.ip = 0.0.0.0